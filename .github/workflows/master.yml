# on:
#   push:
#     branches:
#       - master
on: [pull_request]

jobs:
  deploy:
    name: deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout sources
        uses: actions/checkout@v2

      - name: Install stable toolchain
        uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          override: true

      - run: yarn install

      - name: setup Docker
        uses: docker-practice/actions-setup-docker@master

      - run: |
          echo "TESTING"
          cargo --version
          docker --version

      - name: serverless deploy
        uses: serverless/github-action@master
        with:
          args: deploy
        env:
          SLS_DEBUG: *
          SERVERLESS_ACCESS_KEY: ${{ secrets.SERVERLESS_ACCESS_KEY }}
